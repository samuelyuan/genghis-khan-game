<!DOCTYPE html>
<html lang="en">
<head>
  <title>Genghis Khan Game</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
  <link rel="stylesheet" href="/css/jquery-jvectormap-2.0.5.css" type="text/css" media="screen"/>
  <style>
    .stat-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-family: monospace;
    }
    
    .stat-label {
      font-weight: bold;
      color: #333;
    }
    
    .stat-value {
      color: #666;
    }
    
    .sell-option, .upgrade-action {
      text-align: center;
      margin: 15px 0;
      font-size: 0.9em;
      color: #666;
    }
    
    .action-hint {
      font-style: italic;
    }
    
    .upgrade-preview {
      margin-top: 15px;
    }
    
    .upgrade-preview .stat-value {
      color: #28a745;
    }
    
    #unitStatsModal .modal-body {
      background-color: #f8f9fa;
      padding: 20px;
    }
    
    #unitStatsModal .modal-header {
      background-color: #f8f9fa;
      color: #333;
    }
    
    #unitStatsModal .modal-title {
      color: #333 !important;
      font-weight: bold;
    }
    
    .unit-type-btn {
      transition: all 0.2s ease;
      min-height: 40px;
      padding: 6px 10px;
      font-size: 0.85rem;
      margin: 0 2px;
    }
    
    .unit-type-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .unit-type-btn.btn-primary {
      background-color: #007bff !important;
      border-color: #007bff !important;
      color: white !important;
    }
    
    .unit-type-btn .badge {
      font-size: 0.75rem;
      margin-right: 4px;
    }
    
    #itemTerrain {
      text-align: center;
      padding: 10px;
    }
    
    #itemTerrain img {
      border: 2px solid #ddd;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: transform 0.2s ease;
    }
    
    #itemTerrain img:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
  </style>
  <script src="/js/jquery-3.5.1.min.js"></script>
  <script src="/js/jquery-jvectormap-2.0.5.min.js"></script>
  <script src="/js/popper.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/game/map/eurasia-map.js"></script>
  <audio src="/audio/mainMusic.mp3" loop></audio>
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-sm-2"></div>
      <div class="col-sm-8">
        <h2>Genghis Khan Game</h2>
        <p><b>Objective:</b> Conquer all countries in the known world.</p>
        <p>
          <button class="btn btn-info" id="instructionsButton" data-toggle="modal" data-target="#instructionsModal">
            Instructions
          </button>
          <button class="btn btn-dark" id="audioButton">
            Enable audio
          </button>
        </p>
        <div id="world-map">
          <div class="card">
            <div class="card-body" id="homeCountryStatus"></div>
          </div>
          <div id="world-map-container" style="width: 800px; height: 600px"></div>
        </div>
                 <div id="battle-map">
           <div class="card">
             <div class="card-body">
               <div class="row align-items-center">
                 <div class="col-md-4">
                   <button type="button" class="btn btn-success" id="buttonFightBattle">Fight</button>
                   <button type="button" class="btn btn-danger" id="buttonRetreatBattle">Retreat</button>
                 </div>
                 <div class="col-md-8">
                   <div class="d-flex justify-content-end">
                     <div class="text-center me-3">
                       <small class="text-muted d-block mb-1">Select Unit Type</small>
                       <div id="unitTypeSelector" class="d-flex gap-2">
                         <!-- Unit type buttons will be generated here -->
                       </div>
                     </div>
                   </div>
                 </div>
               </div>
             </div>
           </div>
           <canvas id="battleScreen" width="800" height="400"></canvas>
          <div class="col">
            <nav aria-label="...">
              <ul class="pagination pagination-lg">
                <li class="list-group-item">
                  <p>
                    <div id="itemCurrentCountryHealth" style="width: 200px; height: 10px; background: #ff5100;"></div>
                  </p>
                  <p id="itemCurrentCountryName"></p>
                </li>
                <li class="list-group-item" id="itemTerrain"></li>
                <li class="list-group-item">
                  <p>
                    <div id="itemEnemyCountryHealth" style="width: 200px; height: 10px; background: #0051ff;"></div>
                  </p>
                  <p id="itemEnemyCountryName"></p>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
      <div class="col-sm-2"></div>
    </div>
  </div>
  <script src="/game/core/Main.js" type="module"></script>

  <div class="modal fade" id="instructionsModal" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Instructions</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>
            <b>1. Select a country to invade</b><br/>

            You are presented with a map - you can only invade countries adjacent to territories
            you have already conquered. Click on countries to see their strengths and terrain types.
          </p>
          <p>
            To invade a country, you click the "Declare War" button.
          </p>
          <p>
            <b>2. Buy units</b><br/>

            To buy units, you can click on any tile in the staging area to place units. Your units will start at level 0, but
            they will gain experience as they fight and become stronger.

            If you click on a unit in the staging area, you can upgrade it.
          </p>
          <p>
            <b>3. Fight</b><br/>

            Once you have positioned your units in the staging area, click the "Fight" button to begin the battle.
          </p>
          <p>
            If the battle is going poorly, you can click the "Retreat" button to get out of that battle and find another country
            to invade. Retreating will cost you 10% of the power you had before you began the current battle.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
</div>

  <!-- Modal -->
  <div class="modal fade" id="countryModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"></h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal" id="declareWar">Declare War</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="countryModalInvalid" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"></h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="newGameModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"></h4>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-success" data-dismiss="modal" id="newGame">New Game</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Unit Stats Modal -->
  <div class="modal fade" id="unitStatsModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Your Unit</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <!-- Current Stats -->
          <div class="current-stats">
            <div class="stat-row">
              <span class="stat-label">COST:</span>
              <span class="stat-value" id="unitCost"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">TYPE:</span>
              <span class="stat-value" id="unitType"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">LEVEL:</span>
              <span class="stat-value" id="unitLevel"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">POWER:</span>
              <span class="stat-value" id="unitPower"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">HP:</span>
              <span class="stat-value" id="unitHP"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">EXP:</span>
              <span class="stat-value" id="unitExp"></span>
            </div>
          </div>

          <!-- Sell Option -->
          <div class="sell-option">
            <span class="action-hint">Sell for 75% of original cost</span>
          </div>

          <hr style="border-top: 1px dashed #ccc;">

          <!-- Upgrade Preview -->
          <div class="upgrade-preview">
            <div class="stat-row">
              <span class="stat-label">COST:</span>
              <span class="stat-value" id="upgradeCost"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">LEVEL:</span>
              <span class="stat-value" id="upgradeLevel"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">POWER:</span>
              <span class="stat-value" id="upgradePower"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">HP:</span>
              <span class="stat-value" id="upgradeHP"></span>
            </div>
            <div class="stat-row">
              <span class="stat-label">EXP:</span>
              <span class="stat-value" id="upgradeExp"></span>
            </div>
          </div>

          <!-- Upgrade Action -->
          <div class="upgrade-action">
            <span class="action-hint">Upgrade to next level</span>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-warning" id="sellUnit">Sell Unit (S)</button>
          <button type="button" class="btn btn-primary" id="upgradeUnit">Upgrade Unit (U)</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
