<!DOCTYPE html>
<html lang="en">

<head>
  <title>Genghis Khan Game</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
  <link rel="stylesheet" href="/css/jquery-jvectormap-2.0.5.css" type="text/css" media="screen" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    /* Unit Stats Modal - New Table Layout */
    .unit-type-display {
      margin-bottom: 20px;
    }

    .unit-type-display h6 {
      color: #495057;
      font-weight: 600;
    }

    .stats-table-container {
      margin-bottom: 20px;
    }

    .stats-comparison-table {
      margin-bottom: 0;
      font-size: 14px;
    }

    .stats-comparison-table th {
      background-color: #f8f9fa !important;
      border-color: #dee2e6;
      font-weight: 600;
      color: #495057;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stats-comparison-table td {
      border-color: #dee2e6;
      vertical-align: middle;
      padding: 8px 12px;
    }

    .stats-comparison-table .stat-label {
      font-weight: 600;
      color: #495057;
      background-color: #f8f9fa;
    }

    .stats-comparison-table .stat-value {
      font-weight: 600;
      text-align: center;
      font-family: 'Courier New', monospace;
    }

    .stats-comparison-table .current-value {
      color: #6c757d;
      background-color: #f8f9fa;
    }

    .stats-comparison-table .upgrade-value {
      color: #28a745;
      background-color: #f8f9fa;
    }

    .action-hints {
      border-top: 1px solid #dee2e6;
      padding-top: 15px;
    }

    .sell-option,
    .upgrade-action {
      margin: 8px 0;
      font-size: 0.9em;
      color: #6c757d;
      font-style: italic;
    }

    .action-hint {
      font-style: italic;
    }

    .upgrade-preview {
      margin-top: 15px;
    }

    .upgrade-preview .stat-value {
      color: #28a745;
    }

    #unitStatsModal .modal-body {
      background-color: #f8f9fa;
      padding: 20px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    #unitStatsModal .modal-header {
      background-color: #f8f9fa;
      color: #333;
    }

    #unitStatsModal .modal-title {
      color: #333 !important;
      font-weight: bold;
    }

    /* Retreat Confirmation Modal Styling */
    #retreatConfirmModal .modal-body {
      padding: 30px 20px;
      text-align: center;
    }

    #retreatConfirmModal .fas {
      display: block;
      margin: 0 auto 20px;
    }

    #retreatConfirmModal .text-danger {
      font-weight: 600;
    }

    #retreatConfirmModal .text-info {
      font-size: 0.9em;
    }

    #retreatConfirmModal .modal-footer {
      justify-content: center;
      gap: 10px;
    }

    .unit-type-btn {
      transition: all 0.2s ease;
      min-height: 40px;
      padding: 6px 10px;
      font-size: 0.85rem;
      margin: 0 2px;
    }

    .unit-type-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .unit-type-btn.btn-primary {
      background-color: #007bff !important;
      border-color: #007bff !important;
      color: white !important;
    }

    .unit-type-btn .badge {
      font-size: 0.75rem;
      margin-right: 4px;
    }

    #itemTerrain {
      text-align: center;
      padding: 10px;
    }

    #itemTerrain img {
      border: 2px solid #ddd;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease;
    }

    #itemTerrain img:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    /* Battle Status Panels Styling */
    .battle-status-panels {
      margin-top: 20px;
      padding: 0 15px;
    }

    .battle-panel {
      background: #2c3e50;
      border: 2px solid #34495e;
      border-radius: 8px;
      padding: 20px;
      height: 160px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s ease;
    }

    .panel-header {
      text-align: center;
      margin-bottom: 20px;
      position: relative;
    }

    .country-title,
    .terrain-title {
      color: #ecf0f1;
      font-size: 1.1rem;
      font-weight: 700;
      margin: 0;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .health-bar-container {
      margin-bottom: 20px;
    }

    .health-bar-label {
      color: #bdc3c7;
      font-size: 0.8rem;
      font-weight: 600;
      text-align: center;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .health-bar {
      width: 100%;
      height: 12px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 6px;
      overflow: hidden;
      position: relative;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .health-fill {
      height: 100%;
      border-radius: 6px;
      position: relative;
    }



    .player-health {
      background: linear-gradient(90deg, #e74c3c, #f39c12);
      width: 100%;
    }

    .enemy-health {
      background: linear-gradient(90deg, #3498db, #2980b9);
      width: 100%;
    }

    /* Health bars start at 100% but can be dynamically changed by JavaScript */
    .health-fill {
      width: 100%;
    }

    .health-value {
      color: #ecf0f1;
      font-size: 0.9rem;
      font-weight: 700;
      text-align: center;
      margin-top: 5px;
    }

    .country-stats {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.2s ease;
    }

    .stat-item:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(3px);
    }

    .stat-icon {
      font-size: 1.2rem;
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }

    .stat-label {
      color: #bdc3c7;
      font-size: 0.85rem;
      font-weight: 500;
      flex: 1;
    }

    .stat-value {
      color: #ecf0f1;
      font-size: 0.9rem;
      font-weight: 700;
    }

    .terrain-content {
      text-align: center;
    }

    .terrain-image-container {
      margin-bottom: 15px;
      text-align: center;
    }







    /* Responsive adjustments */
    @media (max-width: 768px) {
      .battle-panel {
        height: auto;
        min-height: 140px;
        margin-bottom: 15px;
      }



      .country-title,
      .terrain-title {
        font-size: 1rem;
      }
    }
  </style>
  <script src="/js/jquery-3.5.1.min.js"></script>
  <script src="/js/jquery-jvectormap-2.0.5.min.js"></script>
  <script src="/js/popper.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/game/map/eurasia-map.js"></script>
  <audio src="/audio/mainMusic.mp3" loop></audio>
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-sm-2"></div>
      <div class="col-sm-8">
        <h2>Genghis Khan Game</h2>
        <p><b>Objective:</b> Conquer all countries in the known world.</p>
        <p>
          <button class="btn btn-info" id="instructionsButton" data-toggle="modal" data-target="#instructionsModal">
            Instructions
          </button>
          <button class="btn btn-dark" id="audioButton">
            Enable audio
          </button>
        </p>
        <div id="world-map">
          <div class="card">
            <div class="card-body" id="homeCountryStatus"></div>
          </div>
          <div id="world-map-container" style="width: 800px; height: 600px"></div>
        </div>
        <div id="battle-map">
          <div class="card">
            <div class="card-body">
              <div class="row align-items-center">
                <div class="col-md-4">
                  <button type="button" class="btn btn-success" id="buttonFightBattle">Fight</button>
                  <button type="button" class="btn btn-danger" id="buttonRetreatBattle" data-toggle="modal"
                    data-target="#retreatConfirmModal">Retreat</button>
                </div>
                <div class="col-md-8">
                  <div class="d-flex justify-content-end">
                    <div class="text-center me-3">
                      <small class="text-muted d-block mb-1">Select Unit Type</small>
                      <div id="unitTypeSelector" class="d-flex gap-2">
                        <!-- Unit type buttons will be generated here -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <canvas id="battleScreen" width="800" height="400"></canvas>
          <div class="col-12">
            <div class="battle-status-panels">
              <div class="row g-3">
                <!-- Player Country Panel -->
                <div class="col-md-4">
                  <div class="battle-panel player-panel">
                    <div class="panel-header player-header">
                      <h5 class="country-title" id="itemCurrentCountryName">Mongolia</h5>
                    </div>
                    <div class="health-bar-container">
                      <div class="health-bar">
                        <div class="health-fill player-health" id="itemCurrentCountryHealth"></div>
                      </div>
                      <div class="health-value">100%</div>
                    </div>
                    <div class="country-stats">
                    </div>
                  </div>
                </div>

                <!-- Terrain Panel -->
                <div class="col-md-4">
                  <div class="battle-panel terrain-panel">
                    <div class="panel-header terrain-header">
                      <h5 class="terrain-title" id="itemTerrainType">Plain</h5>
                    </div>
                    <div class="terrain-content" id="itemTerrain">
                      <div class="terrain-image-container"></div>
                      <div class="terrain-type">Plain</div>
                    </div>
                  </div>
                </div>

                <!-- Enemy Country Panel -->
                <div class="col-md-4">
                  <div class="battle-panel enemy-panel">
                    <div class="panel-header enemy-header">
                      <h5 class="country-title" id="itemEnemyCountryName">China</h5>
                    </div>
                    <div class="health-bar-container">
                      <div class="health-bar">
                        <div class="health-fill enemy-health" id="itemEnemyCountryHealth"></div>
                      </div>
                      <div class="health-value">100%</div>
                    </div>
                    <div class="country-stats">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-2"></div>
    </div>
  </div>
  <script src="/game/core/Main.js" type="module"></script>

  <div class="modal fade" id="instructionsModal" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Instructions</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>
            <b>1. Select a country to invade</b><br />

            You are presented with a map - you can only invade countries adjacent to territories
            you have already conquered. Click on countries to see their strengths and terrain types.
          </p>
          <p>
            To invade a country, you click the "Declare War" button.
          </p>
          <p>
            <b>2. Buy units</b><br />

            To buy units, you can click on any tile in the staging area to place units. Your units will start at level
            0, but
            they will gain experience as they fight and become stronger.

            If you click on a unit in the staging area, you can upgrade it.
          </p>
          <p>
            <b>3. Fight</b><br />

            Once you have positioned your units in the staging area, click the "Fight" button to begin the battle.
          </p>
          <p>
            If the battle is going poorly, you can click the "Retreat" button to get out of that battle and find another
            country
            to invade. Retreating will cost you 10% of the power you had before you began the current battle.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="countryModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"></h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal" id="declareWar">Declare War</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="countryModalInvalid" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"></h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="newGameModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"></h4>
        </div>
        <div class="modal-body"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-success" data-dismiss="modal" id="newGame">New Game</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Retreat Confirmation Modal -->
  <div class="modal fade" id="retreatConfirmModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Retreat</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="text-center">
            <i class="fas fa-exclamation-triangle text-warning" style="font-size: 3rem; margin-bottom: 20px;"></i>
            <h6 class="text-danger mb-3">Warning: Retreating will cost you 10% of your current gold!</h6>
            <p class="text-muted">Are you sure you want to retreat from this battle?</p>
            <p class="text-info"><small>You will lose <span id="retreatPenaltyAmount">0</span> gold if you
                proceed.</small></p>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="confirmRetreat">Yes, Retreat</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Unit Stats Modal -->
  <div class="modal fade" id="unitStatsModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Your Unit</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <!-- Unit Type Display -->
          <div class="unit-type-display">
            <h6 class="text-center mb-3">Unit Type: <span id="unitType" class="badge badge-primary"></span></h6>
          </div>

          <!-- Stats Comparison Table -->
          <div class="stats-table-container">
            <table class="table table-bordered stats-comparison-table">
              <thead>
                <tr class="table-secondary">
                  <th class="text-center">Stat</th>
                  <th class="text-center">Current</th>
                  <th class="text-center">After Upgrade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="stat-label">Cost</td>
                  <td class="stat-value current-value" id="unitCost"></td>
                  <td class="stat-value upgrade-value" id="upgradeCost"></td>
                </tr>
                <tr>
                  <td class="stat-label">Level</td>
                  <td class="stat-value current-value" id="unitLevel"></td>
                  <td class="stat-value upgrade-value" id="upgradeLevel"></td>
                </tr>
                <tr>
                  <td class="stat-label">Power</td>
                  <td class="stat-value current-value" id="unitPower"></td>
                  <td class="stat-value upgrade-value" id="upgradePower"></td>
                </tr>
                <tr>
                  <td class="stat-label">HP</td>
                  <td class="stat-value current-value" id="unitHP"></td>
                  <td class="stat-value upgrade-value" id="upgradeHP"></td>
                </tr>
                <tr>
                  <td class="stat-label">EXP</td>
                  <td class="stat-value current-value" id="unitExp"></td>
                  <td class="stat-value upgrade-value" id="upgradeExp"></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Action Hints -->
          <div class="action-hints mt-3">
            <div class="sell-option text-center">
              <span class="action-hint">Sell for 75% of original cost</span>
            </div>
            <div class="upgrade-action text-center">
              <span class="action-hint">Upgrade to next level</span>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-warning" id="sellUnit">Sell Unit (S)</button>
          <button type="button" class="btn btn-primary" id="upgradeUnit">Upgrade Unit (U)</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</body>

</html>